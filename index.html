<DOCTYPE html>
<html>
	<head>
		<title>Drum machine</title>
	</head>
	<body>
		
		
		<div id="app">
			<div>
				<div id="tracks">
					<div class="track" v-for="track in tracks">
						<div class="pad" v-for="pad in track.pads" v-bind:class="{'active': pad.active}" @click="setActive(pad)"></div>
					</div>
				</div>
				
				<div id="settings">
					<div class="item">
						<label>BPM:</label>
						<input id="bpm-control" type="range" min="50" max="300" value="120" @change="setBPM">
						<span id="bpm-value">{{ bpm }}</span>
					</div>
				</div>
				
			</div>
		</div>
		
		
		
		
		<style>
			
			* {
				box-sizing: border-box;
			}
			
			body * + * {
				margin-top: 10px
			}
			
			#tracks {
				border: 1px solid #aaa;
				padding: 20px;
			}
			
			.track {
				display: grid;
				grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
			}
			
			.pad {
				margin: 2px;
				width: 50px;
				height: 50px;
				border-radius: 4px;
				background-color: #ccc;
				cursor: pointer;
			}
			
			.pad.active {
				background-color: #6c6;
			}
			
			.pad.playing {
				border: 2px solid red;
			}
			
			#settings {
				border: 1px solid #aaa;
				padding: 20px;
			}
			
		</style>
		
		<script src="vue.js"></script>
		
		<script>
			
			const app = new Vue({
				el: '#app',
				data: {
					bpm: 120,
					tracks: [
						// for example
						{
							pads: [
								{active: false, playing: false},
								{active: false, playing: false},
								{active: false, playing: false},
								{active: false, playing: false},
							]
						},
						{
							pads: [
								{active: false, playing: false},
								{active: false, playing: false},
								{active: false, playing: false},
								{active: false, playing: false},
							]
						},
					],
					numberOfTracks: 4,
					numberOfPads: 8,
					currentPad: 0,
					timerId: 0,
				},
				methods: {
					addTrack: (numberOfPads) => {
						const track = {
							id: 0,
							settings: {
								color: gray,
							},
							pads: [],
						};
						for (let i = 0; i < numberOfPads; i++) {
							track.pads.push(false);
						}
						this.tracks.push(track);
					},
					createPads: function(track, numberOfPads) {
						/*for (let i = 0; i < numberOfPads; i++) {
							const pad = document.createElement('div');
							pad.classList.add('pad');
							track.appendChild(pad);
						}*/
					},
					createTracks: function() {
						for (let i = 0; i < this.numberOfTracks; i++) {
							createTrack();
						}
					},
					createTrack: function() {
						const track = {
							//sound: null,
							pads: [],
						};
						track.pads = [];
						
						this.tracks.push(track)
					},
					shiftActivePad: function(n) {
						/*pads.forEach(pad => pad.classList.remove('playing'));
						const playingPad = pads[currentPad];
						playingPad.classList.add('playing');
						currentPad = currentPad == numberOfPads - 1 ? 0 : ++currentPad;*/
					},
					runTimer: function() {
						this.timerId = setInterval(() => {
							this.shiftActivePad();
						}, 1000 * 60 / this.bpm);
					},
					stopTimer: function() {
						clearInterval(this.timerId);
					},
					setBPM: function(event) {
						const bpm = event.target.value;
						this.bpm = bpm;
						this.stopTimer();
						this.runTimer(bpm);
					},
					setActive: function(pad) {
						pad.active = !pad.active;
					},
				},
				
			});
			
		</script>
		
	</body>
</html>